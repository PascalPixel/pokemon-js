<!DOCTYPE html>
<html>
<head>

<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<title>Pokémon Mini by Superpencil</title>
<link href="favicon.ico" rel="shortcut icon" type="image/x-icon">

<!-- iOS Webapp -->
<meta content="width=device-width, initial-scale=1, user-scalable=no"
      name="viewport">
<meta content="width=320.1"
      name="viewport">
<meta content="yes"
      name="apple-mobile-web-app-capable">
<meta content="black"
      name="apple-mobile-web-app-status-bar-style"><!-- Basic -->
<link href="apple-touch-icon-precomposed.png"
      rel="apple-touch-icon-precomposed"><!-- iPhone -->
<link href="apple-touch-icon-57x57-precomposed.png"
      rel="apple-touch-icon-precomposed"
      sizes="57x57">
<link href="apple-touch-startup-image-320x460.png"
      media="(device-width: 320px)"
      rel="apple-touch-startup-image"><!-- iPhone (Retina) -->
<link href="apple-touch-icon-144x144-precomposed.png"
      rel="apple-touch-icon-precomposed"
      sizes="114x114">
<link href="apple-touch-startup-image-640x920.png"
      media="(device-width: 320px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"><!-- iPhone 5 -->
<link href="apple-touch-startup-image-640x1096.png"
      media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image"><!-- iPad -->
<link href="apple-touch-icon-72x72-precomposed.png"
      rel="apple-touch-icon-precomposed"
      sizes="72x72">
<link href="apple-touch-startup-image-768x1004.png"
      media="(device-width: 768px) and (orientation: portrait)"
      rel="apple-touch-startup-image">
<link href="apple-touch-startup-image-748x1024.png"
      media="(device-width: 768px) and (orientation: landscape)"
      rel="apple-touch-startup-image"><!-- iPad (Retina) -->
<link href="apple-touch-icon-144x144-precomposed.png"
      rel="apple-touch-icon-precomposed"
      sizes="144x144">
<link href="apple-touch-startup-image-1536x2008.png"
      media="(device-width: 768px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image">
<link href="apple-touch-startup-image-1496x2048.png"
      media="(device-width: 768px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)"
      rel="apple-touch-startup-image">
<!-- iOS Webapp end -->

<link href="css/bootstrap.scaffolding.css" rel="stylesheet">

<style type='text/css'>

@font-face {
  font-family:'pokemon';
  src:url('font/Pokemon%20GB.ttf');
}

/* Magic Responsiveness */
body {
  font-size: 14px;
  background: #fff;
  color: #333333;
  font-family: 'pokemon', sans-serif;
  text-shadow: 0.143em 0.143em 0 rgba(0,0,0,0.2);
}
.bw {
  background: #e0e0e0;
  color: #000;
  text-shadow: none;
}
.bw * {
  text-shadow: none !important;
  box-shadow: none !important;
  -webkit-filter: none !important;
}
.loader,
.gameboy {
  width: 320px;
  height: 288px;
}
@media (min-width:0px) {
  body {
    font-size: 8px
  }
  .loader,
  .gameboy {
    width: auto;
    height: auto;
  }
}
@media (min-width:200px) {body{font-size: 10px;}}
@media (min-width:250px) {body{font-size: 12px;}}
@media (min-width:300px) {body{font-size: 14px;}}
@media (min-width:350px) {body{font-size: 16px;}}
@media (min-width:400px) {body{font-size: 18px;}}
@media (min-width:450px) {body{font-size: 20px;}}
@media (min-width:500px) {body{font-size: 22px;}}
@media (min-width:550px) {body{font-size: 24px;}}
@media (min-width:600px) {body{font-size: 26px;}}
@media (min-width:650px) {body{font-size: 28px;}}
@media (min-width:700px) {body{font-size: 30px;}}
@media (min-width:750px) {body{font-size: 32px;}}
@media (min-width:800px) {body{font-size: 34px;}}
@media (min-width:850px) {body{font-size: 36px;}}
@media (min-width:900px) {body{font-size: 38px;}}
@media (min-width:950px) {body{font-size: 40px;}}
@media (min-width:1000px){body{font-size: 42px;}}
@media (min-width:1050px){body{font-size: 44px;}}
@media (min-width:1100px){body{font-size: 46px;}}
@media (min-width:1150px){body{font-size: 48px;}}
@media (min-width:1200px){body{font-size: 50px;}}
@media (min-width:1250px){body{font-size: 52px;}}
@media (min-width:1300px){body{font-size: 54px;}}
@media (min-width:1350px){body{font-size: 56px;}}
@media (min-width:1400px){body{font-size: 58px;}}
@media (min-width:1450px){body{font-size: 60px;}}
@media (min-width:1500px){body{font-size: 62px;}}
@media (min-width:1550px){body{font-size: 64px;}}
@media (min-width:1600px){body{font-size: 66px;}}
@media (min-width:1650px){body{font-size: 68px;}}
@media (min-width:1700px){body{font-size: 70px;}}
@media (min-width:1750px){body{font-size: 72px;}}
@media (min-width:1800px){body{font-size: 74px;}}
@media (min-width:1850px){body{font-size: 76px;}}
@media (min-width:1900px){body{font-size: 78px;}}
@media (min-width:1950px){body{font-size: 80px;}}
@media (min-width:2000px){body{font-size: 82px;}}
@media (min-width:2050px){body{font-size: 84px;}}
@media (min-width:2100px){body{font-size: 86px;}}
@media (min-width:2150px){body{font-size: 88px;}}
@media (min-width:2200px){body{font-size: 90px;}}
@media (min-width:2250px){body{font-size: 92px;}}
@media (min-width:2300px){body{font-size: 94px;}}
@media (min-width:2350px){body{font-size: 96px;}}
@media (min-width:2400px){body{font-size: 98px;}}
@media (min-width:2450px){body{font-size:100px;}}
@media (min-width:2500px){body{font-size:102px;}}
@media (min-width:2500px){body{font-size:104px;}}
@media (min-width:2600px){body{font-size:106px;}}
@media (min-width:2650px){body{font-size:108px;}}
@media (min-width:2700px){body{font-size:110px;}}
@media (min-width:2750px){body{font-size:112px;}}
@media (min-width:2800px){body{font-size:114px;}}
@media (min-width:2850px){body{font-size:116px;}}
@media (min-width:2900px){body{font-size:118px;}}
@media (min-width:2950px){body{font-size:120px;}}
@media (min-width:3000px){body{font-size:122px;}}
.loader,
.gameboy {
  overflow: hidden;
  padding: 0.8em;
}
.gameboy {
  overflow: hidden
}
.foe {
  overflow: hidden
}
.foepush {
  padding-left: 1.286em
}
.row {
  position: relative
}
a {
  text-decoration: none !important;
  color: #333333;
}
p {
  margin: 0;
  padding: 0;
}
footer {
  font-size: 0.571em;
  margin-top: 0.714em;
  line-height: 1.286em;
  display: none;
}
.player .sprite img {
  margin-left: 1.214em
}
.sprite {
  -webkit-filter: drop-shadow(0.143em 0.143em 0.000em rgba(0,0,0,0.3));
}
.player .image {
  left: 71.429em;
  position: relative;
}
.foe .image {
  position: relative;
  right: 71.429em;
}
.player .stats {
  background-image: url(img/color/ash_line.png);
  background-position: center bottom;
  background-repeat: no-repeat;
  background-size: 100%;
  margin-bottom: 0.357em;
  padding-bottom: 1.286em;
  margin-right: 1.214em;
}
.bw .player .stats {
  background-image: url(img/color/ash_line.png);
}
.foe .stats {
  background-image: url(img/color/gary_line.png);
  background-position: center bottom;
  background-repeat: no-repeat;
  background-size: 100%;
  padding-bottom: 0.143em;
}
.bw .foe .stats {
  background-image: url(img/color/gary_line.png);
}
.menu .button {
  display: inline-block;
  margin: 0.571em 0 0;
}
.button:hover {
  cursor: pointer
}
.healthbar {
  background-color: #30cb30;
  height: 0.214em;
  width: 100%;
}
.bw .healthbar {
  background-color: #a6a6a6 !important;
}
.healthbarcontainer {
  border: 0.143em solid rgba(0,0,0,0.75);
  border-radius: 0.357em;
  box-shadow: 0.143em 0.143em 0 rgba(0,0,0,0.3);
  margin: 0 1.071em 0.714em 2.857em;
  display: block;
}
.health {
  float: right;
  margin-right: 1.071em;
  margin-top: -0.357em;
}
img {
  max-width: 100%
}
.hp {
  display: inline-block
}
.menu {
  background: #fff;
  display: none;
  float: right;
  margin: -1.786em -2.143em -1.071em 0;
  width: 12.286em;
  height: 6.071em;
  padding-top: 0.429em;
  padding-left: 0.929em;
}
.fight-menu,
.item-menu,
.pkmn-menu {
  background: #fff;
  bottom: -1.071em;
  display: none;
  padding-top: 0.357em;
  position: absolute;
  right: -1.429em;
}
.bw .menu,
.bw .fight-menu,
.bw .item-menu,
.bw .pkmn-menu {
  background: #e0e0e0;
}
.item-menu,
.pkmn-menu {
  left: -1.071em;
  right: -1.071em;
  top: -7.857em;
  bottom: -1.071em;
}
.relative { 
  position: relative
}
.messages {
  display: block;
  margin: 0;
  height: 6.071em;
}
.text {
  margin-left: -1em;
  margin-top: 0.5em;
  margin-right: -1em;
}
.hp_img {
  margin-left: -2.143em;
  position: absolute;
  width: 1.429em;
  margin-top: -0.143em;
}
.frame {
  -moz-border-image: url(img/color/border.png) 41 41 repeat;
  -o-border-image: url(img/color/border.png) 41 41 repeat;
  -webkit-border-image: url(img/color/border.png) 41 41 repeat;
  border-image: url(img/color/border.png) 41 41 fill repeat;
  border-style: solid;
  border-width: 1.071em;
}
.link {
  background-color: rgba(255,0,0,0.8);
  border-radius: 0.214em;
  color: #e5e7e2;
  padding: 0.286em 0.357em 0.143em;
  text-shadow: none;
}
.bw .link {
  background-color: rgba(185,185,185,0.8);
}
.battle { display: none }
.loader {
  display: block;
  margin-top: -21.429em;
  padding-top: 5.714em;
  text-align: center;
}
.loader a {
  border-radius: 0.357em;
  padding: 0.571em 0.714em 0.286em;
}
.player {
  position: relative;
  margin-top: -2.143em;
  overflow-y: hidden;
}
.messages span { margin-right: -1.000em }
.statswrap {
  position: absolute;
  bottom: 0;
  right: 0;
}
.foe,
.player {
  overflow: hidden
}
.image {
  padding-bottom: 0.357em
}
.logo {
  width: 7.143em
}
.levelsign {
  margin: -0.357em 0 -0.071em 3.214em
}
.levelsign img {
  width: 0.857em
}
</style>
</head>

<body>

<div class="loader">
  <div class="row">
    <div class="col-xs-12">
      <img class="logo" src="img/color/superpencil.png"><br>
      <br>
      <a class="link big" href="http://www.superpencil.com">Superpencil</a>
    </div>
  </div>
</div>

<div class="gameboy">
  <div class="battle">

    <div class="row foe">
      <div class="col-xs-7">
        <div class="foepush">
          <div class="gary_balls"><img src="img/color/gary_balls.png"></div>
          <div class="stats">
            <span class="name" style="margin-left:0.929em;"></span><br>
            <div class="levelsign"><img src="img/color/l.png"><span class="level"></span></div>
            <div class="healthbarcontainer"><img class="hp_img" src="img/color/hp.png"><div class="healthbar"></div></div>
          </div>
        </div>
      </div>
      <div class="col-xs-5 image">
        <div class="gary_black"><img src="img/color/gary_black.png"></div>
        <div class="gary"><img src="img/color/gary.png"></div>
        <div class="sprite"></div>
      </div>
    </div>

    <div class="row player">
      <div class="col-xs-5 image">
        <div class="ash_black"><img src="img/color/ash_black.png"></div>
        <div class="ash"><img src="img/color/ash.png"></div>
        <div class="sprite"></div>
      </div>
      <div class="col-xs-7 statswrap">
        <div class="ash_balls"><img src="img/color/ash_balls.png"></div>
        <div class="stats">
          <span class="name" style="margin-left:0.929em;"></span><br>
          <div class="levelsign"><img src="img/color/l.png"><span class="level"></span></div>
          <div class="healthbarcontainer"><img class="hp_img" src="img/color/hp.png"><div class="healthbar"></div></div>
          <div class="health"><span class="hp"></span>/ <span class="hpTotal"></span></div>
        </div>
      </div>
    </div>

    <div class="row messages frame relative">
      <div class="col-xs-12">
        <p class="text text1"></p>
        <p class="text text2"></p>
        <div class="menu frame">
          <div class="button fight">FIGHT</div>
          <div class="button pkmn"><sup>P</sup><sub>K</sub><sup>M</sup><sub>N</sub></div>
          <div class="button item">ITEM&nbsp;</div>
          <div class="button run">RUN</div>
        </div>
        <div class="fight-menu frame">
          <div class="button tackle" id="move0"></div>
          <div class="button tackle" id="move1"></div>
          <div class="button tackle" id="move2"></div>
          <div class="button tackle" id="move3"></div>
          <div class="button back">cancel</div>
        </div>
        <div class="item-menu frame">
          <div class="button potion">POTION x <span class="potionCount">1</span></div>
          <div class="button back" style="position:absolute;bottom:1.429em;">cancel</div>
        </div>
        <div class="pkmn-menu frame">
          <div class="button playerPokemonButton"><span class="playerpokemonname"></span></div>
          <div class="button back">cancel</div>
        </div>
      </div>
    </div>

  </div>
</div>

<footer class="container">
  <div class="row">
    <div class="col-xs-3"><img src="img/color/superpencil.png"></div>
    <div class="col-xs-9">
      Created by <a href="http://www.superpencil.com">Superpencil</a><br>
      Designer & developer<br> <a class="link" href="mailto:pascal@superpencil.com">for hire</a><br>
      <br>
      Pokémon & Pikachu are trademarks of The Pokémon Company & Nintendo Inc.<br>
    </div>
  </div>
</footer>

<script src="js/jquery-1.10.2.min.js" type='text/javascript'></script>
<script src="js/json3.min.js" type='text/javascript'></script>
<script type='text/javascript'>
$(document).ready(function() {

//GAMEBOY Aspect ratio
/*var windowHeight = $(window).height();
$('.gameboy').css('max-width', windowHeight); 
$(window).resize(function() {
    var windowHeight = $(window).height();
    $('.gameboy').css('max-width', windowHeight); 
});*/

function getQueryVariable(variable)
{
  var query = window.location.search.substring(1);
  var vars = query.split("&");
  for (var i=0;i<vars.length;i++) {
    var pair = vars[i].split("=");
    if(pair[0] == variable){return pair[1];}
  }
  return(false);
}

//Color or B&W
if (getQueryVariable("color") != 0) {
  var colorSetting = 'bw';
  $('body').addClass('bw');
} else {
  var colorSetting = 'color';
}

//Initiate Player
var player = "Ash";
if (getQueryVariable("playerdex") != 0) {
  var playerID = getQueryVariable("playerdex");
} else {
  var playerID = 25;
}
if (getQueryVariable("foedex") != 0) {
  var foeID = getQueryVariable("foedex");
} else {
  var foeID = 133;
}
if (getQueryVariable("level") != 0) {
  var playerLevel = getQueryVariable("level");
  var foeLevel = getQueryVariable("level");
} else {
  var playerLevel = 5;
  var foeLevel = 5;
}
var playerPokemon = pokedex(playerID,playerLevel);
var hpPlayerTotal = playerPokemon['hp'];
var hpPlayer = hpPlayerTotal;
var playerBaseAttack = playerPokemon['atk'];
var playerBaseDefense = playerPokemon['def'];
$('.player .level').text(playerLevel);
$('.player .hp').text(hpPlayerTotal);
$('.player .hpTotal').text(hpPlayerTotal);
$('.player .name').text(playerPokemon['name'].toUpperCase());
$('.player .sprite').html("<img src='img/"+colorSetting+"/back/"+playerID+".gif'/>");

//Initiate Foe
var foe = "Gary";
var foePokemon = pokedex(foeID,foeLevel);
var hpFoeFull = foePokemon['hp'];
var hpFoe = hpFoeFull;
var foeBaseAttack = foePokemon['atk'];
var foeBaseDefense = foePokemon['def'];
$('.foe .level').text(playerLevel);
$('.foe .name').text(foePokemon['name'].toUpperCase());
$('.foe .sprite').html("<img src='img/"+colorSetting+"/front/"+foeID+".gif'/>");

/*--- Pokédex ---*/
function pokedex(dex, level) {
  $.ajax({
    'async': false,
    'global': false,
    'url': "js/pokemon.json",
    'dataType': "json",
    'success': function (data) {
        poke = data;
    }
  });
  var stats = new Object();
      stats['id'] = poke[dex].id;
      stats['name'] = poke[dex].name;
      stats['hp']  = Math.floor((poke[dex].stats.hp * 2 + 193) * level / 100 + 5);
      stats['atk'] = Math.floor(((poke[dex].stats.attack * 2 + 193) * level / 100 + 10) * level / 100 + 20);
      stats['def'] = Math.floor((poke[dex].stats.defense * 2 + 193) * level / 100 + 10);
      stats['spa'] = Math.floor(((poke[dex].stats.spattack * 2 + 193) * level / 100 + 10) * level / 100);
      stats['spd'] = Math.floor((poke[dex].stats.spdefense * 2 + 193) * level / 100 + 10);
      stats['spe'] = Math.floor((poke[dex].stats.speed * 2 + 193) * level / 100 + 10);
  return stats;
}

/*--- Moves ---*/
function loadMoves(dex, lvl) {
  $.ajax({
    'async': false,
    'global': false,
    'url': "js/pokemon.json",
    'dataType': "json",
    'success': function (data) {
        themoves = data;
    }
  });
  var i = 0;
  var move = new Object();
  var amount = themoves[dex].moves.level;
  amount.forEach(function(entry) {
    if (themoves[dex].moves.level[i].learnedat <= lvl) {
      move[i] = themoves[dex].moves.level[i].name.toUpperCase();
    }
    i++;
  });
  return move;
}
var playerMoves = loadMoves(playerID, playerLevel);
var foeMoves = loadMoves(foeID, foeLevel);
$('#move0').html(playerMoves[3]);
$('#move1').html(playerMoves[2]);
$('#move2').html(playerMoves[1]);
$('#move3').html(playerMoves[0]);

/*--- Setup ---*/

//Typer
var typer = function() {
  $('div.messages .text1, div.messages .text2').each(function() {
    $(this).text($(this).text().replace(/ /g, '\u00A0'));
  });
  var line = $('div.messages .text1, div.messages .text2');
  line.hide().contents().each(function() {
    var letters;
    letters = '<span> ' + this.data.split("").join(' <\/span><span> ') + ' <\/span>';
    $(this).replaceWith(letters);
  });
  line.find('span').hide().each(function() {
    if (!$.trim(this.innerHTML)) {
      $(this).remove();
    }
  });
  line.show().find('span').each(function(i) {
    $(this).delay(40 * i).fadeIn(0);
  });
};

//Potioncount
var potionCount = 1;
$(".potionCount").text(potionCount);


/*--- Variables ---*/

//Menu closer
function reset() {
  $(".item-menu, .pkmn-menu, .fight-menu").css('display', 'none');
  $("p.text1").text(" ");
  $("p.text2").text(" ");
  $(".menu").css('display', 'block');
}

//Hide menus
function hider() {
  $(".menu, .item-menu, .pkmn-menu, .fight-menu").css('display', 'none');
};

//Convert health to percentage
function healthbar(current, total) {
  var hpCurrent = current;
  var hpTotal = total;
  var percentTotal = 100;
  var percentCurrent = (hpCurrent * percentTotal) / hpTotal;
  return percentCurrent;
}

//End of attack and return attack
function attackEnd() {
  if (hpFoe <= 8) {
    $(".foe .healthbar").css('background-color', 'red');
  };
  //Win
  if (hpFoe <= 0) {
    $(".menu").css('display', 'none');
    $(".foe .healthbar").css('width', '0%');
    window.setTimeout(function() {
      $(".foe .image").delay(500).animate({
        bottom: "-35.714em"
      }, 1000);
      $("p.text1").text(foePokemon['name'].toUpperCase()+" fainted!");
      $("p.text2").text("");
      typer();
      window.setTimeout(function() {
        $(".foe .stats").css('display', 'none');
        $("p.text1").text("Got $"+Math.floor(playerLevel*2.5)+" for");
        $("p.text2").text("winning!");
        typer();
        window.setTimeout(function() {
          $("p.text1").text(foe.toUpperCase()+": I can't");
          $("p.text2").text("believe it!");
          typer();
          window.setTimeout(function() {
            $("p.text1").text("I chose the");
            $("p.text2").text("wrong POKéMON!");
            typer();
            window.setTimeout(function() {
              $(".gameboy").hide();
              $("footer").show();
            }, 2000);
          }, 2000);
        }, 2000);
      }, 2000);
    }, 2000);
  }
  //Return attack
  else {
    window.setTimeout(function() {
      $("p.text1").text(foePokemon['name'].toUpperCase()+" used");
      $("p.text2").text(foeMoves[Math.floor(Math.random()*3)].toUpperCase()+"!");
      typer();
      $(".foe .image").animate({
          left: "0.714em"
      }, 100, "linear").animate({
          left: "-1.429em"
      }, 50, "linear").delay(100).animate({
          left: "0.000em"
      }, 10, "linear");
      window.setTimeout(function() {
        $(".player .image").css('opacity', 0);
        window.setTimeout(function() {
          $(".player .image").css('opacity', 1);
          window.setTimeout(function() {
            $(".player .image").css('opacity', 0);
            window.setTimeout(function() {
              $(".player .image").css('opacity', 1);
              window.setTimeout(function() {
                $(".player .image").css('opacity', 0);
                window.setTimeout(function() {
                  $(".player .image").css('opacity', 1);
                  window.setTimeout(function() {
                    var basePower = 40;
                    var baseDamage = Math.floor(Math.floor(Math.floor(2*playerLevel/5+2) * basePower * foePokemon['atk']/playerPokemon['def'])/50) + 2;
                    hpPlayer -= baseDamage;
                    if (hpPlayer <= 7) {
                      $(".player .healthbar").css('background-color', 'red');
                    };
                    if (hpPlayer <= 0) {
                      $(".menu").css('display', 'none');
                      $(".player .hp").text("0");
                      $(".player .healthbar").css('width', '0%');
                      $(".player .stats").css('display', 'none');
                      window.setTimeout(function() {
                        $(".player .image").delay(500).animate({
                          bottom: "-35.714em"
                        }, 1000);
                        $("p.text1").text(playerPokemon['name'].toUpperCase()+" fainted...");
                        $("p.text2").text("");
                        typer();
                        window.setTimeout(function() {
                          $("p.text1").text(player.toUpperCase()+" is out of");
                          $("p.text2").text("useable POKéMON...");
                          typer();
                          window.setTimeout(function() {
                            $("p.text1").text(player.toUpperCase()+" whited out!");
                            $("p.text2").text(" ");
                            typer();
                            window.setTimeout(function() {
                              $(".gameboy").hide();
                              $("footer").show();
                            }, 2000);
                          }, 2000);
                        }, 2000);
                      }, 2000);
                    } else {
                      $(".player .hp").text(hpPlayer);
                      $(".player .healthbar").animate({
                        width: healthbar(hpPlayer, hpPlayerTotal) + '%'
                      }, 500);
                      window.setTimeout(function() {
                        reset();
                      }, 2400);
                    };
                  }, 100);
                }, 100);
              }, 100);
            }, 100);
          }, 100);
        }, 100);
      }, 100);
    }, 2000);
  }
};

//Growl
function growl() {
  hider();
  $("p.text1").text(playerPokemon['name'].toUpperCase());
  $("p.text2").text("used GROWL!");
  typer();
  window.setTimeout(function() {
    if (foeBaseDefense < (foePokemon['def'] - 20)) {
      $("p.text1").text(foePokemon['name'].toUpperCase()+"\'s defense");
      $("p.text2").text("can\'t drop lower!");
      typer();
      window.setTimeout(function() {
        attackEnd();
      }, 2000);
    } else {
      $("p.text1").text(foePokemon['name'].toUpperCase()+"\'s defense");
      $("p.text2").text("dropped by 2!");
      foeBaseDefense-2;
      typer();
      window.setTimeout(function() {
        attackEnd();
      }, 2000);
    }
  }, 2000);
};

//Tackle
function attack(moveName) {
  hider();
  $("p.text1").text(playerPokemon['name'].toUpperCase()+" used");
  $("p.text2").text(moveName.toUpperCase()+"!");
  typer();
  $(".player .image").animate({
      left: "-0.714em"
  }, 100, "linear").animate({
      left: "1.429em"
  }, 50, "linear").delay(100).animate({
      left: "0.000em"
  }, 10, "linear");
  window.setTimeout(function() {
    $(".foe .image").css('opacity', 0);
    window.setTimeout(function() {
      $(".foe .image").css('opacity', 1);
      window.setTimeout(function() {
        $(".foe .image").css('opacity', 0);
        window.setTimeout(function() {
          $(".foe .image").css('opacity', 1);
          window.setTimeout(function() {
            $(".foe .image").css('opacity', 0);
            window.setTimeout(function() {
              $(".foe .image").css('opacity', 1);
              var basePower = 40;
              var baseDamage = Math.floor(Math.floor(Math.floor(2*playerLevel/5+2) * basePower * playerPokemon['atk']/foePokemon['def'])/50) + 2;
              hpFoe -= baseDamage;
              $(".foe .healthbar").animate({
                width: healthbar(hpFoe, hpFoeFull) + '%'
              }, 500);
              attackEnd();
            }, 100);
          }, 100);
        }, 100);
      }, 100);
    }, 100);
  }, 100);
};

//potion use
function potion(potionStrength) {
  hider();
  if (potionStrength == "normal") {
    var theStrength = 20;
  } else if (potionStrength == "super") {
    var theStrength = 50;
  } else if (potionStrength == "hyper") {
    var theStrength = 200;
  } else if (potionStrength == "max") {
    var theStrength = 999;
  }
  if (hpPlayer >= hpPlayerTotal) {
    $("p.text1").text("HP already");
    $("p.text2").text("full!");
    typer();
    window.setTimeout(function() {
      reset();
    }, 1000);
  } else {
    $("p.text1").text("Used POTION!");
    $("p.text2").text(" ");
    typer();
    hpPlayer += theStrength;
    if (hpPlayer >= hpPlayerTotal) {
      hpPlayer = hpPlayerTotal;
    }
    $(".player .hp").text(hpPlayer);
    $(".player .healthbar").animate({
      width: healthbar(hpPlayer, hpPlayerTotal) + '%'
    }, 500);
    $(".player .healthbar").css('background-color', 'green');
    potionCount--;
    attackEnd();
  }
  $(".potionCount").text(potionCount);
  if (potionCount <= 0) {
    $(".potion").css('display', 'none');
  }
};


/*--- Opening Animation ---*/

$(".loader").animate({
  marginTop: "0.000em"
}, 2000, 'linear');
window.setTimeout(function() {
  $(".loader").css('display', 'none');
  $(".battle").css('display', 'block');
  //Opening animations trainers
  $(".sprite, .gary, .ash, .stats, .ash_balls, .gary_balls").css('display', 'none');
  $(".foe .image").animate({
    right: "0.000em"
  }, 2000, 'linear');
  $(".player .image").animate({
    left: "0.000em"
  }, 2000, 'linear');
  window.setTimeout(function() {
    $(".gary, .ash, .ash_balls, .gary_balls").css('display', 'block');
    $(".gary_black, .ash_black").css('display', 'none');
    window.setTimeout(function() {
      $("p.text1").text(foe.toUpperCase()+" wants");
      $("p.text2").text("to fight!");
      typer();
      window.setTimeout(function() {
        $(".ash_balls, .gary_balls").css('display', 'none');
        $(".foe .image").animate({
          right: "-71.429em"
        }, 700, 'linear');
        window.setTimeout(function() {
          $("p.text1").text(foe.toUpperCase()+" sent");
          $("p.text2").text("out "+foePokemon['name'].toUpperCase()+"!");
          typer();
          $(".foe .sprite").css('display', 'block');
          $(".gary").css('display', 'none');
          $(".foe .image").animate({
            right: "0.000em"
          }, 1300, 'linear');
          window.setTimeout(function() {
            $(".foe .stats").css('display', 'block');
            $(".player .image").animate({
              left: "-71.429em"
            }, 700, 'linear');
            window.setTimeout(function() {
              $(".ash").css('display', 'none');
              $(".player .sprite").css('display', 'block');
              $(".foe .stats").css('display', 'block');
              $(".player .image").animate({
                left: "0.000em"
              }, 1300, 'linear');
              $("p.text1").text("Go! "+playerPokemon['name'].toUpperCase()+"!");
              $("p.text2").text(" ");
              typer();
              $(".player .stats").css('display', 'block');
              window.setTimeout(function() {
                reset();
              }, 3000);
            }, 1500);
          }, 2000);
        }, 1000);
      }, 2000);
    }, 400);
  }, 2010);
}, 3000);

/*--- Interactions ---*/

//Open item menu
$('.item').click(function() {
  $(".item-menu").css('display', 'block');
});

//Potion
$('.potion').click(function() {
  potion("normal");
});

//Fight
$('.fight').click(function() {
  $(".fight-menu").css('display', 'block');
});

//Stats Attacks
$('.growl').click(function() {
  growl();
});

//Damage Attacks
$('#move0').click(function(){attack(playerMoves[3]);});
$('#move1').click(function(){attack(playerMoves[2]);});
$('#move2').click(function(){attack(playerMoves[1]);});
$('#move3').click(function(){attack(playerMoves[0]);});

//Back
$('.back').click(function() {
  reset();
});

//Pokemon
$('.pkmn').click(function() {
  $(".pkmn-menu").css('display', 'block');
});

//Run
$('.run').click(function() {
  hider();
  $("p.text1").text("You can't run from");
  $("p.text2").text("a POKéMON battle!");
  typer();
  window.setTimeout(function() {
    reset();
  }, 2000);
});

});
</script>

</div>
</body>
</html>